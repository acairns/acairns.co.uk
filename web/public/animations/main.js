import{E as M,V as g,u as E,a as R,S as P,P as A,b as w,c as k,d as S,e as D}from"./Vector-e62a7f0b.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();const q="modulepreload",z=function(l){return"/animations/"+l},I={},L=function(e,t,i){if(!t||t.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(t.map(a=>{if(a=z(a),a in I)return;I[a]=!0;const r=a.endsWith(".css"),u=r?'[rel="stylesheet"]':"";if(!!i)for(let c=s.length-1;c>=0;c--){const d=s[c];if(d.href===a&&(!r||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${u}`))return;const o=document.createElement("link");if(o.rel=r?"stylesheet":q,r||(o.as="script",o.crossOrigin=""),o.href=a,document.head.appendChild(o),r)return new Promise((c,d)=>{o.addEventListener("load",c),o.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>e()).catch(a=>{const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=a,window.dispatchEvent(r),!r.defaultPrevented)throw a})};class N extends M{async dispatch(e){await Promise.all(this.notifySubscribers(e))}}function y(l,e=document.createElement("canvas")){const t=e.getContext("2d",l);if(!t)throw new Error("Could not create a 2D context.");return t}class F{constructor(e){this.playback=e}secondsToFrames(e){return Math.ceil(e*this.playback.fps)}framesToSeconds(e){return e/this.playback.fps}get time(){return this.framesToSeconds(this.playback.frame)}get frame(){return this.playback.frame}get speed(){return this.playback.speed}get fps(){return this.playback.fps}get state(){return this.playback.state}}class B{get onDataChanged(){return this.data.subscribable}constructor(e){this.logger=e,this.data=new g(null),this.context=new AudioContext,this.audioElement=new Audio,this.source=null,this.error=!1,this.abortController=null,this.offset=0}getTime(){return this.toAbsoluteTime(this.audioElement.currentTime)}setTime(e){this.audioElement.currentTime=this.toRelativeTime(e)}setOffset(e){this.offset=e}setMuted(e){this.audioElement.muted=e}setVolume(e){this.audioElement.volume=e}setSource(e){var t;this.source=e,this.audioElement.src=e,(t=this.abortController)==null||t.abort(),this.abortController=new AbortController,this.loadData(this.abortController.signal).catch(i=>{i.name!=="AbortError"&&this.logger.error(i)})}isInRange(e){return e>=this.offset&&e<this.audioElement.duration}toRelativeTime(e){return Math.max(0,e-this.offset)}toAbsoluteTime(e){return e+this.offset}isReady(){return this.source&&!this.error}async setPaused(e){if(this.source&&this.audioElement.paused!==e)if(e)this.audioElement.pause();else try{return await this.audioElement.play(),this.error=!1,!0}catch(t){this.error||E().error(t),this.error=!0}return!1}async loadData(e){if(this.data.current=null,!this.source)return;const i=await(await fetch(this.source,{signal:e})).arrayBuffer();if(e.aborted)return;let s;try{s=await this.decodeAudioData(i)}catch{return}if(e.aborted)return;const a=256,r=~~(s.length/a),u=[];let h=0;for(let o=0;o<s.numberOfChannels;o++){const c=s.getChannelData(o);for(let d=0;d<r;d++){const v=~~(d*a),x=~~(v+a);let p=c[v],f=p;for(let b=v;b<x;b++){const m=c[b];m>f&&(f=m),m<p&&(p=m)}(o===0||f>u[d*2])&&(u[d*2]=f),(o===0||p<u[d*2+1])&&(u[d*2+1]=p),f>h&&(h=f),Math.abs(p)>h&&(h=Math.abs(p))}}this.data.current={peaks:u,absoluteMax:h,length:r,sampleRate:s.sampleRate/a*2}}decodeAudioData(e){return new Promise((t,i)=>this.context.decodeAudioData(e,t,i).catch(i))}}class Z{get onChanged(){return this.events.subscribable}constructor(e){this.scene=e,this.events=new g([]),this.registeredEvents=new Map,this.lookup=new Map,this.collisionLookup=new Set,this.previousReference=[],this.didEventsChange=!1,this.preserveTiming=!0,this.handleReload=()=>{this.registeredEvents.clear(),this.collisionLookup.clear()},this.handleRecalculated=()=>{var t;this.preserveTiming=!0,this.events.current=[...this.registeredEvents.values()],(this.didEventsChange||(((t=this.previousReference)==null?void 0:t.length)??0)!==this.events.current.length)&&(this.didEventsChange=!1,this.previousReference=[...this.registeredEvents.values()].map(i=>({name:i.name,targetTime:i.targetTime})),this.scene.meta.timeEvents.set(this.previousReference))},this.handleReset=()=>{this.collisionLookup.clear()},this.handleMetaChanged=t=>{t!==this.previousReference&&(this.previousReference=t,this.load(t),this.scene.reload())},this.previousReference=e.meta.timeEvents.get(),this.load(this.previousReference),e.onReloaded.subscribe(this.handleReload),e.onRecalculated.subscribe(this.handleRecalculated),e.onReset.subscribe(this.handleReset),e.meta.timeEvents.onChanged.subscribe(this.handleMetaChanged,!1)}set(e,t,i=!0){let s=this.lookup.get(e);!s||s.offset===t||(this.preserveTiming=i,s={...s,targetTime:s.initialTime+t,offset:t},this.lookup.set(e,s),this.registeredEvents.set(e,s),this.events.current=[...this.registeredEvents.values()],this.didEventsChange=!0,this.scene.reload())}register(e,t){if(this.collisionLookup.has(e))return this.scene.logger.error({message:`name "${e}" has already been used for another event name.`,stack:new Error().stack}),0;this.collisionLookup.add(e);let i=this.lookup.get(e);if(!i)this.didEventsChange=!0,i={name:e,initialTime:t,targetTime:t,offset:0,stack:new Error().stack},this.lookup.set(e,i);else{let s=!1;const a={...i},r=new Error().stack;a.stack!==r&&(a.stack=r,s=!0),a.initialTime!==t&&(a.initialTime=t,s=!0);const u=Math.max(0,a.targetTime-a.initialTime);this.preserveTiming&&a.offset!==u&&(a.offset=u,s=!0);const h=a.initialTime+a.offset;!this.preserveTiming&&a.targetTime!==h&&(this.didEventsChange=!0,a.targetTime=h,s=!0),s&&(i=a,this.lookup.set(e,i))}return this.registeredEvents.set(e,i),i.offset}load(e){for(const t of e){const i=this.lookup.get(t.name)??{name:t.name,initialTime:0,offset:0};this.lookup.set(t.name,{...i,targetTime:t.targetTime})}}}const C=1/50;class j{get onRender(){return this.render.subscribable}get onStateChanged(){return this.playerState.subscribable}get onFrameChanged(){return this.frame.subscribable}get onDurationChanged(){return this.duration.subscribable}get onRecalculated(){return this.recalculated.subscribable}get startFrame(){return Math.min(this.playback.duration,this.status.secondsToFrames(this.startTime))}get endFrame(){return Math.min(this.playback.duration,this.status.secondsToFrames(this.endTime))}get finished(){return this.playback.finished||this.playback.frame>=this.endFrame}constructor(e,t={},i={},s=-1){var r,u,h;this.project=e,this.settings=t,this.initialState=i,this.initialFrame=s,this.render=new N,this.frame=new g(0),this.duration=new g(0),this.recalculated=new R,this.lock=new P,this.startTime=0,this.endTime=1/0,this.requestId=null,this.renderTime=0,this.requestedSeek=-1,this.requestedRecalculation=!0,this.active=!1,this.playerState=new g({loop:!0,muted:!0,volume:1,speed:1,...i,paused:!0}),this.requestedSeek=s,this.logger=this.project.logger,this.playback=new A,this.status=new F(this.playback),this.audio=new B(this.logger),this.size=t.size??new w(1920,1080),this.resolutionScale=t.resolutionScale??1,this.startTime=((r=t.range)==null?void 0:r[0])??0,this.endTime=((u=t.range)==null?void 0:u[1])??1/0,this.playback.fps=t.fps??60,this.audio.setOffset(t.audioOffset??0),e.audio&&this.audio.setSource(e.audio);const a=[];for(const o of e.scenes){const c=new o.klass({...o,playback:this.status,logger:this.project.logger,size:this.size,resolutionScale:this.resolutionScale,timeEventsClass:Z});(h=o.onReplaced)==null||h.subscribe(d=>{c.reload(d)},!1),c.onReloaded.subscribe(()=>this.requestRecalculation()),c.variables.updateSignals(e.variables??{}),a.push(c)}this.playback.setup(a),this.activate()}async configure(e){await this.lock.acquire();let t=this.playback.frame,i=!1;if(this.startTime=e.range[0],this.endTime=e.range[1],this.playback.fps!==e.fps){const s=e.fps/this.playback.fps;this.playback.fps=e.fps,t=Math.floor(t*s),i=!0}(!e.size.exactlyEquals(this.size)||e.resolutionScale!==this.resolutionScale)&&(this.size=e.size,this.resolutionScale=e.resolutionScale,this.playback.reload({size:this.size,resolutionScale:this.resolutionScale})),e.audioOffset!==void 0&&this.audio.setOffset(e.audioOffset),this.lock.release(),i&&(this.playback.reload(),this.frame.current=t,this.requestRecalculation(),this.requestedSeek=t)}isInRange(e){return e>=0&&e<=this.playback.duration}isInUserRange(e){return e>=this.startFrame&&e<=this.endFrame}requestSeek(e){this.requestedSeek=this.clampRange(e)}requestPreviousFrame(){this.requestedSeek=this.frame.current-this.playback.speed}requestNextFrame(){this.requestedSeek=this.frame.current+this.playback.speed}requestReset(){this.requestedSeek=0}toggleLoop(e=!this.playerState.current.loop){e!==this.playerState.current.loop&&(this.playerState.current={...this.playerState.current,loop:e})}togglePlayback(e=this.playerState.current.paused){e===this.playerState.current.paused&&(this.playerState.current={...this.playerState.current,paused:!e},e&&!this.playerState.current.loop&&this.playback.frame===this.playback.duration&&this.requestReset())}toggleAudio(e=this.playerState.current.muted){e===this.playerState.current.muted&&(this.playerState.current={...this.playerState.current,muted:!e})}setAudioVolume(e){const t=S(0,1,e);t!==this.playerState.current.volume&&(this.playerState.current={...this.playerState.current,volume:t})}addAudioVolume(e){this.setAudioVolume(this.playerState.current.volume+e)}setSpeed(e){e!==this.playerState.current.speed&&(this.playback.speed=e,this.playback.reload(),this.playerState.current={...this.playerState.current,speed:e},this.requestRecalculation())}setVariables(e){for(const t of this.playback.onScenesRecalculated.current)t.variables.updateSignals(e)}activate(){this.active=!0,this.request()}deactivate(){this.active=!1,this.requestId!==null&&(cancelAnimationFrame(this.requestId),this.requestId=null)}requestRecalculation(){this.requestedRecalculation=!0,this.request()}async prepare(){const e={...this.playerState.current,seek:this.requestedSeek};if(this.requestedSeek=-1,this.requestedRecalculation){e.seek<0&&(e.seek=this.playback.frame);try{await this.playback.recalculate(),this.duration.current=this.playback.frame,this.recalculated.dispatch()}catch(i){throw this.requestSeek(e.seek),i}finally{this.requestedRecalculation=!1}}(!e.loop&&this.finished&&!e.paused&&e.seek<0||this.endFrame===this.startFrame)&&(this.togglePlayback(!1),e.paused=!0,e.seek=this.endFrame===this.startFrame?e.seek:this.startFrame),e.loop&&(e.seek>this.endFrame||this.finished&&!e.paused)&&this.startFrame!==this.endTime&&(e.seek=this.startFrame);const t=e.paused||this.finished||!this.audio.isInRange(this.status.time);return await this.audio.setPaused(t)&&this.syncAudio(-3),this.audio.setMuted(e.muted),this.audio.setVolume(e.volume),e}async run(){const e=await this.prepare(),t=this.playback.state;if(this.playback.state=e.paused?k.Paused:k.Playing,e.seek>=0||!this.isInUserRange(this.status.frame)){const i=e.seek<0?this.status.frame:e.seek,s=this.clampRange(i);this.logger.profile("seek time"),await this.playback.seek(s),this.logger.profile("seek time"),this.syncAudio(-3)}else if(e.paused||e.speed===1&&this.audio.isReady()&&this.audio.isInRange(this.status.time)&&this.audio.getTime()<this.status.time){e.paused&&t!==k.Paused&&await this.render.dispatch(),!e.paused&&this.status.time>this.audio.getTime()+C&&this.syncAudio(),this.request();return}else if(this.audio.isReady()&&e.speed===1&&this.audio.isInRange(this.status.time)&&this.status.framesToSeconds(this.playback.frame+1)<this.audio.getTime()-C){const i=this.status.secondsToFrames(this.audio.getTime());await this.playback.seek(i)}else this.status.frame<this.endFrame&&(await this.playback.progress(),e.speed!==1&&this.syncAudio());!e.paused&&this.playback.currentScene.slides.isWaiting()&&(this.togglePlayback(!1),e.paused=!0),await this.render.dispatch(),this.frame.current=this.playback.frame,this.request()}request(){this.active&&(this.requestId??(this.requestId=requestAnimationFrame(async e=>{if(this.requestId=null,e-this.renderTime>=1e3/(this.status.fps+5)){this.renderTime=e,await this.lock.acquire();try{await this.run()}catch(t){this.logger.error(t)}this.lock.release()}else this.request()})))}clampRange(e){return S(this.startFrame,this.endFrame,e)}syncAudio(e=0){this.audio.setTime(this.status.framesToSeconds(this.playback.frame+e))}}class O{get canvasSize(){return this.size.scale(this.resolutionScale)}constructor(){this.background=null,this.resolutionScale=1,this.colorSpace="srgb",this.size=w.zero,this.finalBuffer=document.createElement("canvas"),this.currentBuffer=document.createElement("canvas"),this.previousBuffer=document.createElement("canvas");const e=this.colorSpace;this.context=y({colorSpace:e},this.finalBuffer),this.currentContext=y({colorSpace:e},this.currentBuffer),this.previousContext=y({colorSpace:e},this.previousBuffer)}configure({colorSpace:e=this.colorSpace,size:t=this.size,resolutionScale:i=this.resolutionScale,background:s=this.background}){e!==this.colorSpace&&(this.colorSpace=e,this.context=y({colorSpace:e},this.finalBuffer),this.currentContext=y({colorSpace:e},this.currentBuffer),this.previousContext=y({colorSpace:e},this.previousBuffer)),(!t.exactlyEquals(this.size)||i!==this.resolutionScale)&&(this.resolutionScale=i,this.size=t,this.resizeCanvas(this.context),this.resizeCanvas(this.currentContext),this.resizeCanvas(this.previousContext)),this.background=typeof s=="string"?s:(s==null?void 0:s.serialize())??null}async render(e,t){const i=t?D(e.previousOnTop):!1;t&&await t.render(this.previousContext),await e.render(this.currentContext);const s=this.canvasSize;this.context.clearRect(0,0,s.width,s.height),this.background&&(this.context.save(),this.context.fillStyle=this.background,this.context.fillRect(0,0,s.width,s.height),this.context.restore()),t&&!i&&this.context.drawImage(this.previousBuffer,0,0),this.context.drawImage(this.currentBuffer,0,0),i&&this.context.drawImage(this.previousBuffer,0,0)}resizeCanvas(e){const t=this.canvasSize;e.canvas.width=t.width,e.canvas.height=t.height}}var H=Object.defineProperty,V=(l,e,t)=>e in l?H(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t,n=(l,e,t)=>(V(l,typeof e!="symbol"?e+"":e,t),t);const G=`.initial{display:none}.state-initial .initial{display:block}.loading{display:none}.state-loading .loading{display:block}.ready{display:none}.state-ready .ready{display:block}.error{display:none}.state-error .error{display:block}:host{position:relative;display:block}.overlay{position:absolute;left:0;right:0;top:0;bottom:0;display:flex;align-items:center;justify-content:center;opacity:0;background-color:#0000008a;transition:opacity .1s}.overlay.state-ready:not(.auto){cursor:pointer}.overlay.playing:not(.hover):hover{cursor:none}.overlay.hover,.overlay.state-ready:focus-within,.overlay.state-ready:not(.playing){opacity:1}.overlay.hover .button,.overlay.state-ready:focus-within .button,.overlay.state-ready:not(.playing) .button{scale:1;transition:scale .1s ease-out}.overlay.state-loading,.overlay.state-error{opacity:1;transition:opacity 1s}.overlay.state-ready.auto{opacity:0}.button{width:50%;max-width:96px;aspect-ratio:1;scale:.5;transition:scale .1s ease-in,opacity .1s;background-color:transparent;border:none;background-size:100% 100%;background-repeat:no-repeat;opacity:.54;cursor:inherit;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgZmlsbD0iI2ZmZmZmZiI+PHBhdGggZD0iTTAgMGgyNHYyNEgwVjB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTEyIDJDNi40OCAyIDIgNi40OCAyIDEyczQuNDggMTAgMTAgMTAgMTAtNC40OCAxMC0xMFMxNy41MiAyIDEyIDJ6bS0yIDE0LjV2LTlsNiA0LjUtNiA0LjV6Ii8+PC9zdmc+)}.playing .button{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIGZpbGw9IiNmZmZmZmYiPjxnPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iMjQiIHdpZHRoPSIyNCIvPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iMjQiIHdpZHRoPSIyNCIvPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iMjQiIHdpZHRoPSIyNCIvPjwvZz48Zz48Zy8+PHBhdGggZD0iTTEyLDJDNi40OCwyLDIsNi40OCwyLDEyczQuNDgsMTAsMTAsMTBzMTAtNC40OCwxMC0xMFMxNy41MiwyLDEyLDJ6IE0xMSwxNkg5VjhoMlYxNnogTTE1LDE2aC0yVjhoMlYxNnoiLz48L2c+PC9zdmc+)}.button:focus,.overlay:hover .button{opacity:.87}.auto .button{display:none}.canvas{width:100%;display:block;opacity:0;transition:opacity .1s}.canvas.state-ready{opacity:1}.message{font-family:JetBrains Mono,sans-serif;text-align:center;font-size:20px;padding:8px 16px;margin:16px;border-radius:4px;color:#fff9;background-color:#000000de}.loader{width:50%;max-width:96px;display:none;rotate:-90deg;animation:stroke 2s cubic-bezier(.5,0,.5,1) infinite,rotate 2s linear infinite}@keyframes stroke{0%{stroke-dasharray:5.6548667765px 50.8938009883px;stroke-dashoffset:2.8274333882px}50%{stroke-dasharray:50.8938009883px 5.6548667765px;stroke-dashoffset:-2.8274333882px}to{stroke-dasharray:5.6548667765px 50.8938009883px;stroke-dashoffset:-53.7212343766px}}@keyframes rotate{0%{rotate:-110deg}to{rotate:250deg}}
`,W=`<div class="overlay">
  <button title="Play / Pause" class="button ready" tabindex="0"></button>
  <div class="message error">
    An error occurred while loading the animation.
  </div>
  <svg
    class="loader loading"
    viewBox="0 0 24 24"
    stroke="#ffffff"
    stroke-width="2"
    fill="transparent"
  >
    <circle cx="12" cy="12" r="9" />
  </svg>
</div>
`,J=`<style>${G}</style>${W}`,T="motion-canvas-player";class U extends HTMLElement{constructor(){super(),n(this,"root"),n(this,"canvas"),n(this,"overlay"),n(this,"button"),n(this,"state","initial"),n(this,"project",null),n(this,"player",null),n(this,"defaultSettings"),n(this,"abortController",null),n(this,"mouseMoveId",null),n(this,"finished",!1),n(this,"playing",!1),n(this,"connected",!1),n(this,"stage",new O),n(this,"handleMouseMove",()=>{this.mouseMoveId&&clearTimeout(this.mouseMoveId),this.hover&&!this.playing&&this.setPlaying(!0),this.mouseMoveId=window.setTimeout(()=>{this.mouseMoveId=null,this.updateClass()},2e3),this.updateClass()}),n(this,"handleMouseLeave",()=>{this.hover&&this.setPlaying(!1),this.mouseMoveId&&(clearTimeout(this.mouseMoveId),this.mouseMoveId=null,this.updateClass())}),n(this,"handleMouseDown",e=>{e.preventDefault()}),n(this,"handleClick",()=>{this.auto||(this.handleMouseMove(),this.setPlaying(!this.playing),this.button.animate([{scale:"0.9"},{scale:"1",easing:"ease-out"}],{duration:200}))}),n(this,"render",async()=>{this.player&&await this.stage.render(this.player.playback.currentScene,this.player.playback.previousScene)}),this.root=this.attachShadow({mode:"open"}),this.root.innerHTML=J,this.overlay=this.root.querySelector(".overlay"),this.button=this.root.querySelector(".button"),this.canvas=this.stage.finalBuffer,this.canvas.classList.add("canvas"),this.root.prepend(this.canvas),this.overlay.addEventListener("click",this.handleClick),this.overlay.addEventListener("mousemove",this.handleMouseMove),this.overlay.addEventListener("mouseleave",this.handleMouseLeave),this.button.addEventListener("mousedown",this.handleMouseDown),this.setState("initial")}static get observedAttributes(){return["src","quality","width","height","auto","variables"]}get auto(){return!!this.getAttribute("auto")}get hover(){return this.getAttribute("auto")==="hover"}get quality(){const e=this.getAttribute("quality");return e?parseFloat(e):this.defaultSettings.resolutionScale}get width(){const e=this.getAttribute("width");return e?parseFloat(e):this.defaultSettings.size.width}get height(){const e=this.getAttribute("height");return e?parseFloat(e):this.defaultSettings.size.height}get variables(){try{const e=this.getAttribute("variables");return e?JSON.parse(e):{}}catch{return this.project.logger.warn("Project variables could not be parsed."),{}}}setState(e){this.state=e,this.setPlaying(this.playing)}setPlaying(e){var t,i;this.state==="ready"&&(e||this.auto&&!this.hover)?((t=this.player)==null||t.togglePlayback(!0),this.playing=!0):((i=this.player)==null||i.togglePlayback(!1),this.playing=!1),this.updateClass()}updateClass(){this.overlay.className=`overlay state-${this.state}`,this.canvas.className=`canvas state-${this.state}`,this.overlay.classList.toggle("playing",this.playing),this.overlay.classList.toggle("auto",this.auto),this.overlay.classList.toggle("hover",this.mouseMoveId!==null),this.connected&&(this.mouseMoveId!==null||!this.playing?this.dataset.overlay="":delete this.dataset.overlay)}async updateSource(e){var t,i,s,a;this.setState("initial"),(t=this.abortController)==null||t.abort(),this.abortController=new AbortController;let r;try{const h=L(()=>import(e),[]),o=new Promise(c=>setTimeout(c,200));await Promise.any([o,h]),this.setState("loading"),r=(await h).default}catch(h){console.error(h),this.setState("error");return}this.defaultSettings=r.meta.getFullRenderingSettings();const u=new j(r);u.setVariables(this.variables),this.finished=!1,(i=this.player)==null||i.onRender.unsubscribe(this.render),(s=this.player)==null||s.togglePlayback(!1),(a=this.player)==null||a.deactivate(),this.project=r,this.player=u,this.updateSettings(),this.player.onRender.subscribe(this.render),this.player.togglePlayback(this.playing),this.setState("ready")}attributeChangedCallback(e,t,i){var s;switch(e){case"auto":this.setPlaying(this.playing);break;case"src":this.updateSource(i);break;case"quality":case"width":case"height":this.updateSettings();break;case"variables":(s=this.player)==null||s.setVariables(this.variables)}}disconnectedCallback(){var e,t;this.connected=!1,(e=this.player)==null||e.deactivate(),(t=this.player)==null||t.onRender.unsubscribe(this.render)}connectedCallback(){var e,t;this.connected=!0,(e=this.player)==null||e.activate(),(t=this.player)==null||t.onRender.subscribe(this.render)}updateSettings(){const e={...this.defaultSettings,size:new w(this.width,this.height),resolutionScale:this.quality};this.stage.configure(e),this.player.configure(e)}}customElements.get(T)||customElements.define(T,U);
