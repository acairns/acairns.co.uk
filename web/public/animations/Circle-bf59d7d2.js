import{S as B,B as b,y as C,V as I,L as y,d as D,o as m,s as P,q as L,r as S}from"./makeScene2D-6f16dfce.js";import{m as d,b as h,M as v}from"./Vector-e5a505da.js";var $=globalThis&&globalThis.__decorate||function(a,e,t,o){var n=arguments.length,s=n<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(a,e,t,o);else for(var i=a.length-1;i>=0;i--)(r=a[i])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s};class f extends B{constructor(e,t,o,n,s,r){super(),this.startPoint=e,this.radius=t,this.xAxisRotationDegree=o,this.largeArcFlag=n,this.sweepFlag=s,this.endPoint=r,this.xAxisRotation=this.xAxisRotationDegree*d,this.radius=new h(Math.abs(t.x),Math.abs(t.y));const i=e.sub(r).div(2).transform(v.fromRotation(-o).domMatrix),l=i.x*i.x/(t.x*t.x)+i.y*i.y/(t.y*t.y);if(l>1){const w=Math.sqrt(l);t.x=w*t.x,t.y=w*t.y}const c=new h(t.ctg*i.y,t.perpendicular.ctg*i.x).scale(Math.sqrt(1/(i.x*i.x/(t.x*t.x)+i.y*i.y/(t.y*t.y))-1)*(n===s?-1:1));this.xAxisRotationMatrix=v.fromRotation(o).domMatrix,this.center=c.transform(this.xAxisRotationMatrix).add(e.add(r).div(2));const p=i.sub(c).div(t),A=i.scale(-1).sub(c).div(t);this.startAngle=p.radians,this.deltaAngle=h.angleBetween(p,A)%(Math.PI*2),this.sweepFlag===0&&this.deltaAngle>0&&(this.deltaAngle-=Math.PI*2),this.sweepFlag===1&&this.deltaAngle<0&&(this.deltaAngle+=Math.PI*2),f.el.setAttribute("d",`M ${this.startPoint.x} ${this.startPoint.y} A ${this.radius.x} ${this.radius.y} ${this.xAxisRotationDegree} ${this.largeArcFlag} ${this.sweepFlag} ${this.endPoint.x} ${this.endPoint.y}`),this.length=f.el.getTotalLength();const M=new b(f.el.getBBox());this.points=[M.topLeft,M.bottomRight]}getAnglePosition(e){return this.radius.mul(h.fromRadians(e)).transform(this.xAxisRotationMatrix).add(this.center)}getAngleDerivative(e){return new h(-this.radius.x*Math.sin(e),this.radius.y*Math.cos(e)).transform(this.xAxisRotationMatrix)}draw(e,t,o,n){const s=this.startAngle+this.deltaAngle*t,r=this.startAngle+this.deltaAngle*o,i=this.getPoint(t),l=this.getPoint(o);return n&&e.moveTo(i.position.x,i.position.y),e.ellipse(this.center.x,this.center.y,this.radius.x,this.radius.y,this.xAxisRotation,s,r,this.sweepFlag===0),[i,l]}getPoint(e){const t=this.startAngle+e*this.deltaAngle,o=this.getAngleDerivative(t).normalized;return{position:e===0?this.startPoint:e===1?this.endPoint:this.getAnglePosition(t),tangent:o,normal:o.perpendicular}}get arcLength(){return this.length}}$([C(()=>{const a=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","path");return a.appendChild(e),I.shadowRoot.appendChild(a),e})],f,"el",void 0);function z(a,e,t,o,n=!1){const s={arcLength:0,minSin:1,segments:[]};if(t<e){const p=Math.floor((e-t)/(Math.PI*2))+1;t+=Math.PI*2*p}else if(t>e+Math.PI*2){const p=Math.floor((t-e)/(Math.PI*2));t-=Math.PI*2*p}const r=(e+t)/2,i=a.mul(h.fromRadians(e)),l=a.mul(h.fromRadians(t)),c=a.mul(h.fromRadians(r)).scale(n?-1:1);return o&&u(s,new y(h.zero,i)),R(s,a,i,c,e,r,n),R(s,a,c,l,r,t,n),o&&u(s,new y(l,h.zero)),s}function u(a,e){a.segments.push(e),a.arcLength+=e.arcLength}function R(a,e,t,o,n,s,r){const i=Math.abs(n-s)<=180?1:0,l=n>s?0:1,c=r?0:1;u(a,new f(t,e,0,0,i^c^l,o))}var x=globalThis&&globalThis.__decorate||function(a,e,t,o){var n=arguments.length,s=n<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(a,e,t,o);else for(var i=a.length-1;i>=0;i--)(r=a[i])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s};let g=class extends D{constructor(e){super(e)}profile(){return z(this.size().scale(.5),this.startAngle()*d,this.endAngle()*d,this.closed(),this.counterclockwise())}desiredSize(){return{x:this.width.context.getter(),y:this.height.context.getter()}}offsetComputedLayout(e){return e}childrenBBox(){return b.fromSizeCentered(this.computedSize())}getPath(){return this.requiresProfile()?this.curveDrawingInfo().path:this.createPath()}getRipplePath(){return this.createPath(this.rippleSize())}getCacheBBox(){return super.getCacheBBox().expand(this.rippleSize())}createPath(e=0){const t=new Path2D,o=this.startAngle()*d;let n=this.endAngle()*d;const s=this.size().scale(.5).add(e),r=this.closed();if(n>o+Math.PI*2){const i=Math.floor((n-o)/(Math.PI*2));n-=Math.PI*2*i}return r&&t.moveTo(0,0),t.ellipse(0,0,s.x,s.y,0,o,n,this.counterclockwise()),r&&t.closePath(),t}};x([m(0),P()],g.prototype,"startAngle",void 0);x([m(360),P()],g.prototype,"endAngle",void 0);x([m(!1),P()],g.prototype,"counterclockwise",void 0);x([L()],g.prototype,"profile",null);g=x([S("Circle")],g);export{g as C};
